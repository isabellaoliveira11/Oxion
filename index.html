<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Oxion - Plataforma de Ensino</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/lucide@latest"></script>

  <style>
    /* Estilo Global para Centralizar Todos os Modais */
    .modal-overlay {
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 1rem; /* Adiciona um respiro nas laterais em telas pequenas */
    }

    .modal-container {
      max-height: 90vh; /* Garante que o modal não seja maior que a tela */
      overflow-y: auto; /* Adiciona scroll se o conteúdo for muito grande */
    }
  </style>

</head>
<body class="bg-gray-50 text-gray-800">
  <div class="flex h-screen">

    <aside class="w-64 bg-white border-r flex flex-col">
      <div class="p-4 flex items-center gap-2 font-bold text-xl">
        <div class="bg-orange-100 p-2 rounded-full">
          <i data-lucide="graduation-cap" class="w-5 h-5 text-orange-600"></i>
        </div>
        <div>
          <p class="text-gray-900 leading-4">Oxion</p>
          <span class="text-sm text-gray-400 font-normal">Plataforma de Ensino</span>
        </div>
      </div>

      <nav class="flex-1 flex flex-col space-y-1 p-4 text-sm text-gray-700">
        <p class="text-xs text-gray-400 px-2 mb-2 uppercase tracking-wider">Ferramentas de Gestão</p>

        <button class="nav-btn flex items-center gap-3 px-3 py-2 rounded text-left" data-page="dashboard"><i data-lucide="layout-dashboard" class="w-5 h-5"></i><span>Dashboard Geral</span></button>
        <button class="nav-btn flex items-center gap-3 px-3 py-2 rounded text-left" data-page="professores"><i data-lucide="users-round" class="w-5 h-5"></i><span>Professores</span></button>
        <button class="nav-btn flex items-center gap-3 px-3 py-2 rounded text-left" data-page="alunos"><i data-lucide="users" class="w-5 h-5"></i><span>Alunos</span></button>
        <button class="nav-btn flex items-center gap-3 px-3 py-2 rounded text-left" data-page="aulas"><i data-lucide="calendar" class="w-5 h-5"></i><span>Aulas</span></button>
        <button class="nav-btn flex items-center gap-3 px-3 py-2 rounded text-left" data-page="historico"><i data-lucide="history" class="w-5 h-5"></i><span>Histórico de Aulas</span></button>
        <button class="nav-btn flex items-center gap-3 px-3 py-2 rounded text-left" data-page="materiais"><i data-lucide="book-open" class="w-5 h-5"></i><span>Materiais</span></button>
        <button class="nav-btn flex items-center gap-3 px-3 py-2 rounded text-left" data-page="pagamentos"><i data-lucide="credit-card" class="w-5 h-5"></i><span>Pagamentos</span></button>
        <button class="nav-btn flex items-center gap-3 px-3 py-2 rounded text-left" data-page="pacotes"><i data-lucide="layers" class="w-5 h-5"></i><span>Pacotes</span></button>
        <button class="nav-btn flex items-center gap-3 px-3 py-2 rounded text-left" data-page="mensagens"><i data-lucide="message-circle" class="w-5 h-5"></i><span>Mensagens</span></button>
        
        <hr class="my-3 border-gray-200" />
        <p class="text-xs text-gray-400 px-2 mb-2 uppercase tracking-wider">Portais de Acesso</p>
        
        <button class="nav-btn flex items-center gap-3 px-3 py-2 rounded text-left" data-page="portal-professor"><i data-lucide="user-circle" class="w-5 h-5"></i><span>Portal do Professor</span></button>
        <button class="nav-btn flex items-center gap-3 px-3 py-2 rounded text-left" data-page="portal-aluno"><i data-lucide="graduation-cap" class="w-5 h-5"></i><span>Portal do Aluno</span></button>
        
        <div class="mt-auto">
            <a href="login.html" class="flex items-center gap-3 px-3 py-2 rounded text-left text-red-500 hover:bg-red-50">
                <i data-lucide="log-out" class="w-5 h-5"></i>
                <span class="font-semibold">Sair</span>
            </a>
        </div>
      </nav>
    </aside>

    <main class="flex-1 flex flex-col bg-gray-50">
        <header class="bg-white border-b p-4 flex items-center justify-end">
            <div class="flex items-center gap-4">
                <button id="top-bar-mensagens-btn" class="relative text-gray-500 hover:text-gray-800"><i data-lucide="message-circle" class="w-6 h-6"></i><span id="mensagens-count" class="absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-4 h-4 flex items-center justify-center hidden">0</span></button>
                <button id="top-bar-notificacoes-btn" class="relative text-gray-500 hover:text-gray-800"><i data-lucide="bell" class="w-6 h-6"></i><span id="notificacoes-count" class="absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-4 h-4 flex items-center justify-center hidden">0</span></button>
                <div class="w-8 h-8 rounded-full bg-orange-200 text-orange-800 flex items-center justify-center font-semibold">A</div>
            </div>
        </header>

        <div class="flex-1 p-6 overflow-y-auto">
            <section id="dashboard" class="page hidden"><div id="dashboard-content">Carregando...</div></section>
            <section id="professores" class="page hidden"><div id="professores-content">Carregando...</div></section>
            <section id="portal-professor" class="page hidden"><div id="portal-professor-content">Carregando...</div></section>
            <section id="alunos" class="page hidden"><div id="alunos-content">Carregando...</div></section>
            <section id="aulas" class="page hidden"><div id="aulas-content">Carregando...</div></section>
            <section id="historico" class="page hidden"><div id="historico-content">Carregando...</div></section>
            <section id="materiais" class="page hidden"><div id="materiais-content">Carregando...</div></section>
            <section id="pagamentos" class="page hidden"><div id="pagamentos-content">Carregando...</div></section>
            <section id="pacotes" class="page hidden"><div id="pacotes-content">Carregando...</div></section>
            <section id="mensagens" class="page hidden"><div id="mensagens-content">Carregando...</div></section>
            <section id="portal-aluno" class="page hidden"><div id="portal-aluno-content">Carregando...</div></section>
        </div>
    </main>

  </div>

  <script>
    const buttons = document.querySelectorAll('.nav-btn');
    const pages = document.querySelectorAll('.page');

    async function loadAndExecute(pageId) {
      const container = document.getElementById(`${pageId}-content`);
      if (!container) return;

      if (container.dataset.loaded === 'true') {
        if (['dashboard', 'portal-professor', 'portal-aluno'].includes(pageId)) {
            // Força o recarregamento das páginas de portal/dashboard
        } else {
            return;
        }
      }

      try {
        const res = await fetch(`${pageId}.html`, { cache: 'no-store' });
        if (!res.ok) throw new Error(`Arquivo ${pageId}.html não encontrado.`);
        const html = await res.text();
        
        container.innerHTML = html;
        const scripts = Array.from(container.querySelectorAll('script'));
        scripts.forEach(s => {
          const newScript = document.createElement('script');
          newScript.textContent = s.textContent;
          document.body.appendChild(newScript).remove();
        });

        container.dataset.loaded = 'true';
        if (typeof lucide !== 'undefined') {
          lucide.createIcons();
        }
      } catch (e) {
        container.innerHTML = `<div class="p-4 bg-red-50 text-red-600 rounded-lg"><b>Erro ao carregar a página:</b> ${e.message}</div>`;
        console.error(e);
      }
    }

    function showPage(pageId) {
      pages.forEach(p => p.classList.add('hidden'));
      const activePage = document.getElementById(pageId);
      if (activePage) activePage.classList.remove('hidden');

      buttons.forEach(b => {
        b.classList.remove('bg-orange-50', 'text-orange-600', 'font-semibold');
        b.classList.add('hover:bg-gray-100');
        if (b.dataset.page === pageId) {
          b.classList.add('bg-orange-50', 'text-orange-600', 'font-semibold');
          b.classList.remove('hover:bg-gray-100');
        }
      });

      loadAndExecute(pageId);
      localStorage.setItem('oxion_last_page', pageId);
    }

    buttons.forEach(btn => btn.addEventListener('click', () => showPage(btn.dataset.page)));

    const savedPage = localStorage.getItem('oxion_last_page') || 'dashboard';
    showPage(savedPage);

    lucide.createIcons();
  </script>
</body>
</html>